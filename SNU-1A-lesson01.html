<!DOCTYPE html>
<html lang="mn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <title>1A · 1-р хичээл · Үгийн тест</title>

  <style>
    :root{
      --bg:#f0f4f8; --card:#ffffff; --primary:#2d6cdf; --primary2:#1f4ea5;
      --text:#223047; --muted:#6a7a8e; --line:#d9e4f5;
      --warnbg:#fff5f5; --warnline:#feb2b2; --warntext:#7a1f1f;
      --ok:#0f7a3d; --bad:#c0392b; --orange:#e67e22;
    }
    *{box-sizing:border-box}
    html, body{height:100%;}
    body{
      margin:0;
      padding:12px;
      font-family:Arial,sans-serif;
      background:var(--bg);
      color:var(--text);
      text-align:center;
      overflow:hidden; /* ✅ 페이지 스크롤 금지 */
      -webkit-text-size-adjust:100%;
    }

    /* 전체 컨테이너를 화면 높이에 맞춰 flex 레이아웃 */
    .container{
      max-width:560px;
      margin:0 auto;
      height:calc(100vh - 24px); /* body padding(12*2) 제외 */
      background:var(--card);
      padding:14px;
      border-radius:20px;
      border:1px solid var(--line);
      box-shadow:0 10px 20px rgba(0,0,0,0.08);
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    /* ✅ 얇은 고정 헤더 */
    .headerBar{
      position:sticky;
      top:0;
      z-index:10;
      background:var(--card);
      padding-bottom:8px;
      border-bottom:1px solid rgba(0,0,0,0.04);
    }
    .topline{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap:10px;
    }
    .badge{
      display:inline-block;
      padding:4px 10px;
      border-radius:999px;
      border:1px solid #d7dee7;
      background:#f6f9ff;
      font-size:12px;
      font-weight:900;
      color:#2c3e50;
    }
    .nameBox{
      font-size:13px;
      color:#4b5b6f;
      text-align:left;
      line-height:1.25;
    }
    .nameBox b{color:#1f2f45;}
    .btn{
      background:var(--primary);
      color:#fff;
      padding:10px 12px;
      border:none;
      border-radius:12px;
      cursor:pointer;
      font-size:14px;
      font-weight:900;
      transition:.2s;
      white-space:nowrap;
    }
    .btn:hover{background:var(--primary2);}
    .btnGray{background:#eef2f7; color:#223047; border:1px solid #d7dee7;}
    .btnGray:hover{background:#e2e8f0;}

    .warn{
      margin-top:8px;
      background:var(--warnbg);
      border:1px solid var(--warnline);
      border-radius:12px;
      padding:12px;
      color:var(--warntext);
      font-size:14px;
      line-height:1.45;
      text-align:left;
      white-space:pre-line;
    }

    /* ✅ 본문 영역: 남은 공간 사용 */
    .main{
      flex:1;
      min-height:0; /* ✅ 내부 스크롤 가능하게 */
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    /* 퀴즈 섹션 */
    .qno{
      margin-top:2px;
      color:var(--primary);
      font-weight:900;
      font-size:clamp(16px, 4.2vw, 22px);
    }
    .inst{
      margin:0;
      background:#eef2f7;
      border:1px solid #d7dee7;
      padding:10px;
      border-radius:12px;
      color:#223047;
      font-size:13px;
      line-height:1.35;
    }
    .question{
      margin:2px 0 0;
      font-size:clamp(28px, 8vw, 52px); /* ✅ 화면에 맞게 자동 조절 */
      font-weight:900;
      color:#1f2f45;
      line-height:1.08;
      word-break:keep-all;
    }

    /* ✅ 보기 영역만 내부 스크롤 (페이지 스크롤 X) */
    .choicesWrap{
      flex:1;
      min-height:0;
      overflow:auto;
      -webkit-overflow-scrolling:touch;
      padding-bottom:6px;
    }
    .choice{
      width:100%;
      margin:10px 0;
      padding:14px 12px;
      border-radius:14px;
      border:2px solid var(--primary);
      background:#fff;
      color:#223047;
      font-size:clamp(18px, 4.8vw, 22px);
      font-weight:900;
      cursor:pointer;
      transition:.15s;
    }
    .choice:hover{background:var(--primary); color:#fff;}

    .note{
      margin:0;
      color:var(--muted);
      font-size:12px;
      line-height:1.35;
      text-align:left;
    }

    /* 리뷰/결과는 내부 스크롤 허용 */
    .panelScroll{
      flex:1;
      min-height:0;
      overflow:auto;
      -webkit-overflow-scrolling:touch;
      text-align:left;
    }

    .panel{
      margin-top:10px;
      padding:14px;
      border:1px solid var(--line);
      border-radius:14px;
      background:#fff;
    }
    .score{
      font-size:24px;
      font-weight:900;
      color:var(--bad);
      margin:8px 0;
      text-align:center;
    }
    .wrongList{
      max-height:260px;
      overflow:auto;
      padding:12px;
      border-radius:12px;
      border:1px solid var(--warnline);
      background:var(--warnbg);
    }
    .wrongItem{
      padding:8px 0;
      border-bottom:1px dashed var(--warnline);
      font-size:14px;
      line-height:1.35;
    }
    .wrongItem:last-child{border-bottom:none;}

    .resultCard{
      border:2px solid #cfe0ff;
      background:#f6f9ff;
      border-radius:14px;
      padding:14px;
      margin-top:10px;
      text-align:left;
    }
    .resultCard p{margin:8px 0; font-size:14px; line-height:1.5;}
    .bigMsg{font-size:17px; font-weight:900;}
    .center{text-align:center;}

    .btnRow{
      display:flex;
      gap:10px;
      margin-top:10px;
    }
    .btnRow .btn{flex:1; padding:12px 12px;}

    .hidden{display:none;}

    .overlay{
      position:fixed;
      inset:0;
      background:rgba(0,0,0,0.45);
      display:none;
      align-items:center;
      justify-content:center;
      padding:18px;
      z-index:50;
    }
    .modal{
      max-width:560px;
      width:100%;
      background:#fff;
      border-radius:16px;
      padding:16px;
      border:1px solid #d7dee7;
      box-shadow:0 10px 25px rgba(0,0,0,0.18);
      text-align:left;
    }
    .modal h2{margin:0; font-size:18px; color:#1f2f45;}
    .modal p{margin:10px 0; color:#223047; line-height:1.55; font-size:14px;}
  </style>
</head>

<body>
<div class="container">
  <!-- ✅ HEADER -->
  <div class="headerBar">
    <div class="topline">
      <div class="nameBox">
        <div><span class="badge">1A · 1-р хичээл</span></div>
        <div style="margin-top:6px;">Нэр: <b id="studentName">—</b></div>
        <div>Анги: <b id="klassName">—</b></div>
      </div>
      <button class="btn btnGray" onclick="goHome()">Эхлэл</button>
    </div>

    <div id="errorSection" class="warn hidden"></div>
  </div>

  <!-- ✅ MAIN -->
  <div class="main">
    <!-- QUIZ -->
    <div id="quizSection" class="hidden" style="display:flex; flex-direction:column; gap:10px; flex:1; min-height:0;">
      <div class="qno" id="qno"></div>
      <div class="inst" id="inst"></div>
      <div class="question" id="qtext"></div>

      <div class="choicesWrap" id="choicesWrap">
        <div id="choices"></div>
      </div>

      <p class="note">Санамж: Алдаа гаргасан үгсийг төгсгөлд нь дахин харуулна.</p>
    </div>

    <!-- REVIEW -->
    <div id="reviewSection" class="hidden" style="display:flex; flex-direction:column; gap:10px; flex:1; min-height:0;">
      <div class="panelScroll">
        <h1 style="margin:0; font-size:20px; color:var(--orange); text-align:center;">Алдаагаа шалгана уу</h1>
        <p class="note">Эдгээр үгсийг дахин хараад, дараа нь дахин оролдоно уу.</p>

        <div class="panel">
          <div class="score" id="reviewScore"></div>
          <div class="wrongList" id="wrongList"></div>
          <p class="note" id="attemptInfo" style="margin-top:10px;"></p>
        </div>
      </div>

      <div class="btnRow">
        <button class="btn" style="background:var(--orange);" onclick="retry()">Дахин оролдох</button>
        <button class="btn btnGray" onclick="goHome()">Эхлэл</button>
      </div>
    </div>

    <!-- RESULT -->
    <div id="resultSection" class="hidden" style="display:flex; flex-direction:column; gap:10px; flex:1; min-height:0;">
      <div class="panelScroll">
        <h1 style="margin:0; font-size:20px; color:var(--ok); text-align:center;">Тэнцлээ!</h1>

        <div class="resultCard" id="resultCard">
          <p class="bigMsg" id="resultLine1"></p>
          <p class="center"><span class="score" id="finalScore" style="color:var(--ok);"></span></p>
          <p id="resultLine2"></p>
          <p id="resultDate"></p>
          <p style="margin-top:12px; font-weight:900; color:#1f2f45;">
            Энэ дэлгэцийг скриншот хийж багш руугаа илгээнэ үү.
          </p>
          <p class="note" id="logStatus"></p>
        </div>
      </div>

      <div class="btnRow">
        <button class="btn" style="background:var(--ok);" onclick="captureShare()">Капчер</button>
        <button class="btn btnGray" onclick="goHome()">Эхлэл</button>
      </div>
    </div>
  </div>
</div>

<!-- Screenshot Help -->
<div class="overlay" id="overlay" onclick="closeModal(event)">
  <div class="modal">
    <h2>Скриншот хийх арга</h2>
    <p>
      <b>iPhone:</b> Талын товч + Дуу нэмэх товчийг зэрэг дарна уу.<br>
      <b>Android:</b> Асаах товч + Дуу хасах товчийг зэрэг дарна уу.
    </p>
    <p style="font-weight:900; color:#1f2f45;">Дараа нь багш руугаа илгээнэ үү.</p>
    <button class="btn btnGray" onclick="closeModal()">Хаах</button>
  </div>
</div>

<script>
/* =========================
   서버(구글 Apps Script) URL
   ========================= */
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwBe6Y0W3IJKjWV8MLFnR5b9OMePDPHGVACPekJQpvLWRrlayRmHBJCezamKqN9rZg6/exec";

/* =========================
   1A · 1-р хичээл: үгс (40)
   ========================= */
const rawWords = [
  { kor:"공항", mon:"нисэх онгоцны буудал", pos:"n" },
  { kor:"시장", mon:"зах", pos:"n" },

  { kor:"가다", mon:"явах", pos:"v" },
  { kor:"오다", mon:"ирэх", pos:"v" },
  { kor:"마시다", mon:"уух", pos:"v" },
  { kor:"먹다", mon:"идэх", pos:"v" },
  { kor:"사다", mon:"худалдаж авах", pos:"v" },
  { kor:"읽다", mon:"унших", pos:"v" },
  { kor:"요리하다", mon:"хоол хийх", pos:"v" },
  { kor:"주다", mon:"өгөх", pos:"v" },
  { kor:"운동하다", mon:"дасгал хийх", pos:"v" },

  { kor:"영국", mon:"Их Британи", pos:"n" },
  { kor:"호주", mon:"Австрали", pos:"n" },
  { kor:"미국", mon:"Америк", pos:"n" },
  { kor:"프랑스", mon:"Франц", pos:"n" },
  { kor:"독일", mon:"Герман", pos:"n" },
  { kor:"중국", mon:"Хятад", pos:"n" },
  { kor:"일본", mon:"Япон", pos:"n" },
  { kor:"몽골", mon:"Монгол", pos:"n" },
  { kor:"한국", mon:"Солонгос", pos:"n" },

  { kor:"책상", mon:"ширээ", pos:"n" },
  { kor:"의자", mon:"сандал", pos:"n" },
  { kor:"학교", mon:"сургууль", pos:"n" },
  { kor:"도서관", mon:"номын сан", pos:"n" },
  { kor:"집", mon:"гэр", pos:"n" },
  { kor:"식당", mon:"хоолны газар", pos:"n" },
  { kor:"백화점", mon:"их дэлгүүр", pos:"n" },
  { kor:"마트", mon:"дэлгүүр", pos:"n" },

  { kor:"주스", mon:"жүүс", pos:"n" },
  { kor:"피자", mon:"пицца", pos:"n" },

  { kor:"선생님", mon:"багш", pos:"n" },
  { kor:"학생", mon:"оюутан", pos:"n" },
  { kor:"사람", mon:"хүн", pos:"n" },

  { kor:"의사", mon:"эмч", pos:"n" },
  { kor:"기자", mon:"сэтгүүлч", pos:"n" },
  { kor:"요리사", mon:"тогооч", pos:"n" },
  { kor:"가수", mon:"дуучин", pos:"n" },
  { kor:"군인", mon:"цэрэг", pos:"n" },
  { kor:"회사원", mon:"компанийн ажилтан", pos:"n" },

  { kor:"어느", mon:"аль", pos:"o" }
];

/* =========================
   유틸
   ========================= */
function shuffle(arr){
  const a=[...arr];
  for(let i=a.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
  return a;
}

function jsonp(url){
  return new Promise((resolve,reject)=>{
    const cb="cb_"+Date.now()+"_"+Math.floor(Math.random()*10000);
    window[cb]=(data)=>{ resolve(data); script.remove(); try{delete window[cb];}catch(e){window[cb]=undefined;} };
    const script=document.createElement("script");
    script.src=url+(url.includes("?")?"&":"?")+"callback="+cb;
    script.onerror=()=>{ reject(new Error("jsonp_error")); script.remove(); try{delete window[cb];}catch(e){window[cb]=undefined;} };
    document.body.appendChild(script);
  });
}

function getDeviceId(){
  const k="kquiz_deviceId";
  let id=localStorage.getItem(k);
  if(!id){
    const canUUID = (window.crypto && typeof window.crypto.randomUUID === "function");
    id = canUUID ? window.crypto.randomUUID() : ("d_" + Date.now() + "_" + Math.floor(Math.random()*1e9));
    localStorage.setItem(k,id);
  }
  return id;
}

function escapeHtml(s){
  return String(s)
    .replaceAll("&","&amp;").replaceAll("<","&lt;")
    .replaceAll(">","&gt;").replaceAll('"',"&quot;")
    .replaceAll("'","&#39;");
}

/* ✅ 항상 4개 보기 생성 */
function buildChoices({answer, type, pos}){
  const pick = (w) => (type==="kor" ? w.mon : w.kor);

  const samePos = (pos==="o") ? rawWords : rawWords.filter(w => w.pos === pos);
  const allPool = rawWords;

  const candSame = samePos.map(pick).filter(x => x && x !== answer);
  const candAll  = allPool.map(pick).filter(x => x && x !== answer);

  const set = new Set([answer]);

  for(const c of shuffle(candSame)){
    set.add(c);
    if(set.size>=4) break;
  }
  if(set.size<4){
    for(const c of shuffle(candAll)){
      set.add(c);
      if(set.size>=4) break;
    }
  }
  let list=Array.from(set);
  while(list.length<4) list.push(answer);
  return shuffle(list.slice(0,4));
}

/* =========================
   상태
   ========================= */
const lessonId = "SNU-1A-lesson01";
let name="", klass="", token="", deviceId="";
let attempts=0;

let questions=[], idx=0, correct=0, wrong=[];

/* DOM */
const studentNameEl = document.getElementById("studentName");
const klassNameEl = document.getElementById("klassName");
const errorSection = document.getElementById("errorSection");
const quizSection = document.getElementById("quizSection");
const reviewSection = document.getElementById("reviewSection");
const resultSection = document.getElementById("resultSection");

const qnoEl = document.getElementById("qno");
const instEl = document.getElementById("inst");
const qtextEl = document.getElementById("qtext");
const choicesEl = document.getElementById("choices");

const reviewScoreEl = document.getElementById("reviewScore");
const wrongListEl = document.getElementById("wrongList");
const attemptInfoEl = document.getElementById("attemptInfo");

const resultLine1El = document.getElementById("resultLine1");
const finalScoreEl = document.getElementById("finalScore");
const resultLine2El = document.getElementById("resultLine2");
const resultDateEl = document.getElementById("resultDate");
const logStatusEl = document.getElementById("logStatus");

const overlay = document.getElementById("overlay");

/* =========================
   파라미터 & 서버 검증
   ========================= */
function showError(msg){
  errorSection.textContent = msg;
  errorSection.classList.remove("hidden");
  quizSection.classList.add("hidden");
  reviewSection.classList.add("hidden");
  resultSection.classList.add("hidden");
}

function getParams(){
  const p = new URLSearchParams(location.search);
  return {
    name:(p.get("name")||"").trim(),
    klass:(p.get("klass")||"").trim(),
    token:(p.get("token")||"").trim()
  };
}

async function validateToken(){
  const cacheKey = "result_"+token;
  const cached = sessionStorage.getItem(cacheKey);
  if(cached) return true;

  const url = `${SCRIPT_URL}?action=validate&token=${encodeURIComponent(token)}&deviceId=${encodeURIComponent(deviceId)}&klass=${encodeURIComponent(klass)}&name=${encodeURIComponent(name)}`;
  const res = await jsonp(url);
  return !!(res && res.ok);
}

/* =========================
   시도 횟수(이름별)
   ========================= */
function attemptsKey(){ return `attempts_${lessonId}_${name}`; }

function loadAttempts(){
  attempts = parseInt(localStorage.getItem(attemptsKey())||"0",10) || 0;
}
function saveAttempts(){
  localStorage.setItem(attemptsKey(), String(attempts));
}
function clearAttempts(){
  localStorage.removeItem(attemptsKey());
}

/* =========================
   문제 생성/진행
   ========================= */
function prepareQuestions(){
  const shuffled = shuffle(rawWords);
  questions = shuffled.map(w=>{
    const isKorQuestion = Math.random()<0.5;
    const q = isKorQuestion ? w.kor : w.mon;
    const a = isKorQuestion ? w.mon : w.kor;
    const type = isKorQuestion ? "kor" : "mon";
    return { q,a,type,pos:w.pos, choices: buildChoices({answer:a, type, pos:w.pos}) };
  });
  idx=0;
  correct=0;
  wrong=[];
}

function showQuiz(){
  errorSection.classList.add("hidden");
  reviewSection.classList.add("hidden");
  resultSection.classList.add("hidden");
  quizSection.classList.remove("hidden");
  showQuestion();
}

function showQuestion(){
  if(idx>=questions.length){ finish(); return; }
  const item = questions[idx];

  qnoEl.textContent = `${idx+1} / ${questions.length}`;
  instEl.textContent = (item.type==="kor") ? "Зөв монгол утгыг сонгоно уу." : "Зөв солонгос үгийг сонгоно уу.";
  qtextEl.textContent = item.q;

  choicesEl.innerHTML="";
  item.choices.forEach(c=>{
    const btn=document.createElement("button");
    btn.className="choice";
    btn.textContent=c;
    btn.onclick=()=>answer(c);
    choicesEl.appendChild(btn);
  });
}

function answer(choice){
  const item=questions[idx];
  if(choice===item.a){
    correct++;
  }else{
    wrong.push(item);
  }
  idx++;
  showQuestion();
}

function calcScore(){
  if(!questions.length) return 0;
  return Math.round((correct / questions.length) * 100);
}

function finish(){
  attempts++;
  saveAttempts();

  const finalScore = calcScore();
  if(finalScore>=80 || attempts>=5){
    showResult(finalScore, { fromCache:false });
  }else{
    showReview(finalScore);
  }
}

function showReview(finalScore){
  quizSection.classList.add("hidden");
  resultSection.classList.add("hidden");
  reviewSection.classList.remove("hidden");

  reviewScoreEl.innerHTML = `Таны дүн: <b style="color:var(--bad);">${finalScore} оноо</b>`;
  attemptInfoEl.textContent = `Оролдлого: ${attempts} (5 удаа хүрвэл автоматаар тэнцэнэ)`;

  wrongListEl.innerHTML="";
  wrong.forEach(w=>{
    const div=document.createElement("div");
    div.className="wrongItem";
    div.innerHTML = `❓ <b>${escapeHtml(w.q)}</b> → ✅ <b>${escapeHtml(w.a)}</b>`;
    wrongListEl.appendChild(div);
  });
}

async function sendLog(finalScore){
  try{
    const ua = navigator.userAgent || "";
    const url = `${SCRIPT_URL}?action=log&token=${encodeURIComponent(token)}&deviceId=${encodeURIComponent(deviceId)}&book=${encodeURIComponent("SNU")}&lesson=${encodeURIComponent("1A-lesson01")}&score=${encodeURIComponent(String(finalScore))}&attempts=${encodeURIComponent(String(attempts))}&ua=${encodeURIComponent(ua)}`;
    const res = await jsonp(url);

    if(res && res.ok){
      logStatusEl.textContent = "Бүртгэл амжилттай илгээгдлээ.";
      sessionStorage.setItem("result_"+token, JSON.stringify({
        name, klass, finalScore, attempts, t: Date.now(), logged:true
      }));
      return true;
    }else{
      logStatusEl.textContent = "Бүртгэл илгээхэд алдаа гарлаа. Дахин оролдоно уу.";
      return false;
    }
  }catch(e){
    logStatusEl.textContent = "Бүртгэл илгээхэд алдаа гарлаа. Дахин оролдоно уу.";
    return false;
  }
}

async function showResult(finalScore, opts){
  const fromCache = !!(opts && opts.fromCache);

  quizSection.classList.add("hidden");
  reviewSection.classList.add("hidden");
  resultSection.classList.remove("hidden");

  resultLine1El.textContent = `${name}, баяр хүргэе!`;
  finalScoreEl.textContent = `Дүн: ${finalScore} оноо`;
  resultLine2El.textContent = `Оролдлого: ${attempts}`;

  const now = new Date();
  const fmt = new Intl.DateTimeFormat("mn-MN", { year:"numeric", month:"2-digit", day:"2-digit", hour:"2-digit", minute:"2-digit" });
  resultDateEl.textContent = `Огноо: ${fmt.format(now)}`;

  // 합격이면 시도횟수 초기화(단, 캐시로 결과만 보여주는 경우엔 건드리지 않음)
  if(!fromCache){
    clearAttempts();
  }

  // 캐시로 들어온 경우(이미 로그 완료)면 재전송 X
  if(fromCache){
    logStatusEl.textContent = "Бүртгэл илгээгдсэн байна.";
    return;
  }

  logStatusEl.textContent = "Бүртгэл илгээж байна...";
  await sendLog(finalScore);
}

/* 버튼 */
function retry(){
  prepareQuestions();
  showQuiz();
}
function goHome(){
  // 로그인 유지하려면 index.html로만 이동하면 됨(저장소에 남아있음)
  location.href = "index.html";
}

/* 캡처(가능하면 share) */
async function captureShare(){
  const text =
    `Нэр: ${name}\n` +
    `Анги: ${klass}\n` +
    `Хичээл: 1A-lesson01\n` +
    `Дүн: ${finalScoreEl.textContent}\n`;

  try{
    if(navigator.share){
      await navigator.share({ title: "Korean Quiz Result", text });
      return;
    }
  }catch(e){}
  openScreenshotHelp();
}

/* 스크린샷 안내 */
function openScreenshotHelp(){ overlay.style.display="flex"; }
function closeModal(e){
  if(e && e.target && e.target !== overlay) return;
  overlay.style.display="none";
}

/* =========================
   시작
   ========================= */
(async function init(){
  const p=getParams();
  name=p.name; klass=p.klass; token=p.token;
  deviceId=getDeviceId();

  studentNameEl.textContent = name || "—";
  klassNameEl.textContent = klass || "—";

  if(!name || !klass || !token){
    showError("Нэвтрэх мэдээлэл дутуу байна. Эхлэл хуудас руу буцаад дахин нэвтэрнэ үү.");
    return;
  }

  // 결과 캐시가 있으면(이미 기록 전송까지 끝난 상태) 결과만 표시
  const cached = sessionStorage.getItem("result_"+token);
  if(cached){
    try{
      const obj = JSON.parse(cached);
      attempts = obj.attempts || 0;
      const finalScore = obj.finalScore || 0;
      await showResult(finalScore, { fromCache:true });
      return;
    }catch(e){}
  }

  try{
    const ok = await validateToken();
    if(!ok){
      showError("Энэ холбоос хүчинтэй биш байна. Эхлэл хуудас руу буцаад дахин нэвтэрнэ үү.");
      return;
    }
  }catch(e){
    showError("Сервертэй холбогдож чадсангүй. Дахин оролдоно уу.");
    return;
  }

  loadAttempts();
  prepareQuestions();
  showQuiz();
})();
</script>
</body>
</html>
